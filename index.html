<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tax Savings Calculator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f4f7fa;
    }
    .container-main {
      max-width: 700px;
      margin: 30px auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    }
    .section {
      margin-bottom: 30px;
    }
    .tax-box {
      background: #ffffff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.1);
      margin-bottom: 15px;
    }
    .highlight {
      background-color: #e3f2fd;
    }
    .tax-option {
      background-color: #003366;
      color: white;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
      cursor: pointer;
      margin-bottom: 15px;
    }
    .tax-option:hover {
      background-color: #002855;
    }
    h1, h4 {
      color: #333;
    }
    .breakdown-table th, .breakdown-table td {
      padding: 6px;
      border: 1px solid #ddd;
      font-size: 0.85rem;
    }
    .breakdown-table th {
      background-color: #f0f0f0;
      text-align: center;
    }
    .breakdown-table td {
      text-align: center;
      white-space: nowrap;
    }
  </style>
</head>
<body>
  <div class="container-main">
    <!-- Section 1: Tax Cut Options & Total Tax Cut Input -->
    <div class="section">
      <div class="text-center mb-3">
        <div class="row">
          <div class="col-md-4">
            <div class="tax-option" onclick="setTaxCut(20)">$20B</div>
          </div>
          <div class="col-md-4">
            <div class="tax-option" onclick="setTaxCut(100)">$100B</div>
          </div>
          <div class="col-md-4">
            <div class="tax-option" onclick="setTaxCut(1000)">$1T</div>
          </div>
        </div>
      </div>
      <label class="form-label">Total Tax Cut (X in billions):</label>
      <input type="number" id="taxCut" class="form-control" placeholder="e.g., 100" value="10" />
    </div>
  </div>

  <div class="container-main">
    <!-- Section 2: Other User Inputs -->
    <div class="section">
      <label class="form-label">Marital Status:</label>
      <select id="maritalStatus" class="form-select">
        <option value="single">Single</option>
        <option value="married" selected>Married (Jointly)</option>
      </select>
      <label class="form-label mt-3">Income ($):</label>
      <input type="number" id="income" class="form-control" placeholder="e.g., 80000" value="80000" />
    </div>
  </div>
  
  <div class="container-main">
    <!-- Section 3: Summary Savings Output -->
    <div class="section">
      <div class="row">
        <div class="col-md-6 tax-box highlight">
          <h4>Current Tax</h4>
          <div id="currentTax">$9,189.00</div>
        </div>
        <div class="col-md-6 tax-box">
          <h4>New Tax (After Cut)</h4>
          <div id="newTax">$7,589.00</div>
        </div>
      </div>
      <h4 class="mt-3 text-center">Annual Savings: $<span id="savings">1,600.00</span></h4>
    </div>

    <!-- Section 4: Detailed Tax Breakdown -->
    <div class="section">
      <div class="row">
        <div class="col-md-6 tax-box">
          <h4 class="text-center">Current Tax Breakdown</h4>
          <table class="table breakdown-table" id="breakdownCurrent">
            <!-- Table content will be injected here -->
          </table>
        </div>
        <div class="col-md-6 tax-box">
          <h4 class="text-center">New Tax Breakdown</h4>
          <table class="table breakdown-table" id="breakdownNew">
            <!-- Table content will be injected here -->
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Tax bracket definitions for demonstration
    const taxBrackets = {
      single: [
        { min: 0, max: 10275, rate: 0.10 },
        { min: 10275, max: 41775, rate: 0.12 },
        { min: 41775, max: 89075, rate: 0.22 },
        { min: 89075, max: 170050, rate: 0.24 },
        { min: 170050, max: 215950, rate: 0.32 },
        { min: 215950, max: 539900, rate: 0.35 },
        { min: 539900, max: Infinity, rate: 0.37 }
      ],
      married: [
        { min: 0, max: 20550, rate: 0.10 },
        { min: 20550, max: 83550, rate: 0.12 },
        { min: 83550, max: 178150, rate: 0.22 },
        { min: 178150, max: 340100, rate: 0.24 },
        { min: 340100, max: 431900, rate: 0.32 },
        { min: 431900, max: 647850, rate: 0.35 },
        { min: 647850, max: Infinity, rate: 0.37 }
      ]
    };

    // Compute the tax breakdown for an income given an array of brackets
    // For each bracket, we calculate:
    // - Bracket index (starting from 1)
    // - Combined Income Range (min - max)
    // - Taxable Amount (the amount taxed in that bracket)
    // - Rate (as percentage)
    // - Tax for that bracket
    function calculateBracketTax(income, brackets) {
      let remaining = income;
      let breakdown = [];
      let index = 1;
      for (const bracket of brackets) {
        if (income > bracket.min) {
          const taxable = Math.min(remaining, bracket.max - bracket.min);
          const tax = taxable * bracket.rate;
          breakdown.push({
            bracket: index,
            range: `${bracket.min.toLocaleString()} - ${bracket.max === Infinity ? 'âˆž' : bracket.max.toLocaleString()}`,
            taxable: taxable,
            rate: (bracket.rate * 100).toFixed(0) + '%',
            tax: tax
          });
          remaining -= taxable;
          index++;
          if (remaining <= 0) break;
        }
      }
      return breakdown;
    }

    // Render the breakdown into a table with 5 columns:
    // Columns: Bracket, Income Range, Taxable, Rate, Tax
    function renderBreakdown(breakdown, elementId) {
      let html = `<thead>
                    <tr>
                      <th>Bracket</th>
                      <th>Range</th>
                      <th>Taxable</th>
                      <th>Rate</th>
                      <th>Tax</th>
                    </tr>
                  </thead><tbody>`;
      breakdown.forEach(item => {
        html += `<tr>
                   <td>${item.bracket}</td>
                   <td>${item.range}</td>
                   <td>$${item.taxable.toLocaleString('en-US', { minimumFractionDigits: 2 })}</td>
                   <td>${item.rate}</td>
                   <td>$${item.tax.toLocaleString('en-US', { minimumFractionDigits: 2 })}</td>
                 </tr>`;
      });
      html += `</tbody>`;
      document.getElementById(elementId).innerHTML = html;
    }

    // For new tax, reduce each bracket rate by 2 percentage points (but not below 0)
    function adjustBrackets(brackets) {
      return brackets.map(b => ({
        min: b.min,
        max: b.max,
        rate: Math.max(b.rate - 0.02, 0)
      }));
    }

    function setTaxCut(amount) {
      document.getElementById('taxCut').value = amount;
      calculateSavings();
    }

    // Add event listeners to update calculations on input changes
    document.querySelectorAll('#taxCut, #maritalStatus, #income').forEach(input => {
      input.addEventListener('input', calculateSavings);
    });

    // Simple overall tax calculation for summary (for demonstration)
    function calculateTax(income, rate) {
      return income * rate;
    }

    function calculateSavings() {
      const income = parseFloat(document.getElementById('income').value) || 0;
      const maritalStatus = document.getElementById('maritalStatus').value;
      const selectedBrackets = taxBrackets[maritalStatus];

      // Summary overall taxes (using flat rates for demonstration)
      const currentTaxTotal = calculateTax(income, 0.22);
      const newTaxTotal = calculateTax(income, 0.20);

      document.getElementById('currentTax').textContent =
        `$${currentTaxTotal.toLocaleString('en-US', { minimumFractionDigits: 2 })}`;
      document.getElementById('newTax').textContent =
        `$${newTaxTotal.toLocaleString('en-US', { minimumFractionDigits: 2 })}`;
      document.getElementById('savings').textContent =
        (currentTaxTotal - newTaxTotal).toLocaleString('en-US', { minimumFractionDigits: 2 });

      // Detailed breakdown
      const currentBreakdown = calculateBracketTax(income, selectedBrackets);
      const newBreakdown = calculateBracketTax(income, adjustBrackets(selectedBrackets));

      renderBreakdown(currentBreakdown, 'breakdownCurrent');
      renderBreakdown(newBreakdown, 'breakdownNew');
    }

    window.onload = calculateSavings;
  </script>
</body>
</html>
